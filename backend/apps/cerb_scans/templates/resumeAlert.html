{% load custom_filters %}
{% block content %}
<div style="font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; background: #ffffff; padding: 20px; border-radius: 8px; box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1);">
    <h2 style="color: #333; border-bottom: 1px solid #eee; padding-bottom: 10px;">Oju Monitoring Report</h2>
    
    <div style="background-color: #f8f9fa; padding: 15px; border-radius: 5px; margin: 15px 0;">
        <h3 style="margin-top: 0; color: #333;">Summary</h3>
        <ul style="list-style-type: none; padding-left: 0;">
            <li style="margin-bottom: 5px;">Monitored sites: <strong>{{ total_platforms }}</strong></li>
            <li style="margin-bottom: 5px;">Sites with issues: <strong>{{ total_affected_platforms }}</strong></li>
            <li style="margin-bottom: 5px;">Report date: <strong>{{ report_date }}</strong></li>
        </ul>
        
        <h4 style="margin-bottom: 5px;">Detected issues:</h4>
        <ul style="list-style-type: none; padding-left: 0;">
            {% for alert_type, count in alert_stats.items %}
                {% if count > 0 %}
                    <li style="margin-bottom: 5px;">{{ alert_type_names|get:alert_type }}: <strong>{{ count }}</strong></li>
                {% endif %}
            {% endfor %}
        </ul>
    </div>

    {% if alert_stats.ssl > 0 %}{% include "alert_section.html" with alert_type="ssl" %}{% endif %}
    {% if alert_stats.ssl_expiredSoon > 0 %}{% include "alert_section.html" with alert_type="ssl_expiredSoon" %}{% endif %}
    {% if alert_stats.domain_unvailable > 0 %}{% include "alert_section.html" with alert_type="domain_unvailable" %}{% endif %}
    {% if alert_stats.domain_expiredSoon > 0 %}{% include "alert_section.html" with alert_type="domain_expiredSoon" %}{% endif %}
    {% if alert_stats.availability > 0 %}{% include "alert_section.html" with alert_type="availability" %}{% endif %}
    {% if alert_stats.defacement > 0 %}{% include "alert_section.html" with alert_type="defacement" %}{% endif %}
    
    <div style="margin-top: 30px; padding-top: 20px; border-top: 1px solid #eee; color: #555; font-size: 14px;">
        <p>This report was automatically generated by the Oju monitoring system.</p>
        <p>Please take the necessary actions to resolve the identified issues.</p>
    </div>
</div>
{% endblock %}